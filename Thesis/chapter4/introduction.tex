\section{Introduction}
Next, we study the neighborhood analytics in sequence data.
%In this chapter, we study the neighborhood analytics in sequence data.
Sequence data are widely adopted by many applications 
to model events with temporal ordering such as
sports games, temperature reads and stock ticks.
There are two types of entities involved in sequence data model, namely the subject
and the event. Intuitively, the subject performs events at certain time, and the events
are collected. For example, 

An outstanding usage of sequence data is in the field of journalism,
where the journalists strive to
analyze these data to derive attention-seizing news themes. 
While such a task has traditionally been done manually,
there is an increasing reliance on computational technology~\cite{sultana2014incremental,wu2012one,hassan2014data} 
to reduce human labor and intervention to a minimum. Recently,
neighborhood analytics has also been attempted in computational journalism
via the form of \emph{streaks}. A streak is  based on
a \textbf{distance neighborhood} function which aggregates the last few events
of an given event, such as ``the average points a player scored in the last ten games prior to today's game''. 
Based on the streaks, Zhang et. al.~\cite{zhang2014discovering} studied the problem
of summarizing a subject's history with \emph{prominent streaks}. Prominent streaks
are the skylines among all streaks of a subject, and thus are outstanding to represent the subject's history.


%
%They proposed 
%the \emph{prominent streaks} which are the skylines among all streaks of a subject. 
%Each prominent streak is also a striking news theme 
%since it is outstanding (i.e., non-dominated) in a subject's history. 


%Based on the \emph{streak}, Zhang et. al. proposed the \emph{prominent streaks}~\cite{zhang2014discovering}
%to summarize a subject's history.
%The prominent streaks are defined as the skylines among all streaks of a subject, 
%and can be used to represent the history of the subject. 
%Each prominent streak is a striking news theme since it is outstanding (i.e., non-dominated) in a subject's history. 
%
%
%Many applications today generate a large amount of sequence data which 
%embeds a wealth of information. These data are modeled 
%as time-stamped events in chronological order. Typical examples
%include sports game logs, temperature reads and stock ticks.
%An emerging usage of
%these data is the journalism, where journalists strive to derive attention-seizing
%news themes. While such a task has traditionally been done manually,
%there is an increasing reliance on computational technology~\cite{sultana2014incremental,wu2012one,hassan2014data} 
%to reduce human labor and intervention to a minimum. Neighborhood
%analytics has also been attempted recently in the form of \emph{streak}.
%A streak of length $l$ is a \emph{distance neighborhood} function which
%captures the latest $l$ events to the given event such as the last ten games a player participated.
%Based on the \emph{streak}, Zhang et. al. proposed a new type of news theme
%named \emph{prominent streaks}~\cite{zhang2014discovering}. 
%The prominent streaks are defined as the skylines among all streaks of a subject, 
%and can be used to represent the history of the subject. 
%In~\cite{zhang2014discovering}, each prominent streak is viewed as 
%a striking news theme since it is outstanding (i.e., non-dominated) in a subject's history. 

However, there are two major drawbacks that limit the usability
of prominent streaks in real applications.
First, the prominent streaks generated by~\cite{zhang2014discovering} may not be striking enough because they are derived from the historical data of a \emph{single} subject without comparing to other subjects.
For example, 
``Steve Nash has scored 15+ points in consecutive 10 games'' is a prominent streak for ``Steve Nash'', but it is not striking given the fact that there are more than 90 players with better performance\footnote{\url{http://www.sporcle.com/games/nbadarinh/nba-all-players} \\ \url{-with-10-consecutive-20-point-games-90-11}}. 
Second, the number of the prominent streaks can be overwhelming. 
Since prominent streaks in~\cite{zhang2014discovering} are defined as skylines,
%Since~\cite{zhang2014discovering} uses skyline to detect prominent streaks, 
a subject with $n$ historical events may generate at most $n$ streaks that are not dominated (i.e., prominent streaks).
Therefore, there calls for a new method to automatically select a limited number of striking streaks which best summarize a subject's history.

In this chapter, we solve the problem of effectively and efficiently 
summarizing a subject's history by
applying a novel \textbf{comparison neighborhood} function to transform streaks to the \emph{ranked-streaks}. 
The comparison neighborhood function groups the streaks with the same lengths and rank them based on their aggregated values.
We then propose the $k$-Sketch query to select $k$ ranked-streaks 
which best summarize a subject's history.
Compared with previous works,
the ranked-streak is able to capture the strikingness of a streak 
which is very newsworthy as evidenced in the following news excerpts:

%In this chapter, we solve the problem of effectively and efficiently summarizing a subject's history by proposing a \emph{$k$-Sketch} query. The $k$-Sketch query is based on a novel rank-aware streak, named \emph{ranked-streak} and it 
%selects $k$ ranked-streaks which best summarize a subject's history.
%%Compared to the prominent streaks~\cite{zhang2014discovering},
%Compared with previous works,
%the ranked-streak is able to capture the strikingness of a streak which is very newsworthy as evidenced in the following news excerpts:

%
%Today's journalists must pore over large amounts of data to discover attention-seizing facts as \emph{news themes}. While such a task has traditionally been done manually,
%there is an increasing reliance on computational technology~\cite{sultana2014incremental,wu2012one,hassan2014data} to reduce human labor and intervention to a minimum. 
%Recently, Zhang et. al. have introduced 
%a new type of news theme, named \emph{prominent streaks}~\cite{zhang2014discovering}. 
%A streak corresponds to a set of consecutive sequence events belonging to the same subject, such as the latest ten games a player participated.
%The prominent streaks are defined as the skylines among all streaks of a subject, and can be used to represent the history of the  subject. In~\cite{zhang2014discovering}, each prominent streak is viewed as a striking news theme since it is outstanding (i.e., non-dominated) in a subject's history. 
%
%However, there are two major drawbacks that limit the usability
%of prominent streaks in real applications.
%First, the prominent streaks generated by~\cite{zhang2014discovering} may not be striking enough because they are derived from the historical data of a \emph{single} subject without comparing to other subjects.
%For example, 
%``Steve Nash has scored 15+ points in consecutive 10 games'' is a prominent streak for ``Steve Nash'', but it is not striking given the fact that there are more than 90 players with better performance\footnote{\url{http://www.sporcle.com/games/nbadarinh/nba-all-players} \\ \url{-with-10-consecutive-20-point-games-90-11}}. 
%Second, the number of the prominent streaks can be overwhelming. 
%Since prominent streaks in~\cite{zhang2014discovering} are defined as skylines,
%%Since~\cite{zhang2014discovering} uses skyline to detect prominent streaks, 
%a subject with $n$ historical events may generate at most $n$ streaks that are not dominated (i.e., prominent streaks).
%Therefore, there calls for a new method to automatically select a limited number of striking streaks which best summarize a subject's history.
%
%In this chapter, we solve the problem of effectively and efficiently summarizing a subject's history by proposing a \emph{$k$-Sketch} query. The $k$-Sketch query is based on a novel rank-aware streak, named \emph{ranked-streak} and it 
%selects $k$ ranked-streaks which best summarize a subject's history.
%%Compared to the prominent streaks~\cite{zhang2014discovering},
%Compared with previous works,
%the ranked-streak is able to capture the strikingness of a streak which is very newsworthy as evidenced in the following news excerpts:

\begin{enumerate}
\item{(26 Feb 2003) With 32 points, Kobe Bryant saw his 40+ scoring streak end at \textbf{nine} games, tied with Michael Jordan for the \textbf{fourth} place on the all-time list\footnote{\url{http://www.nba.com/features/kobe_40plus_030221.html}}.} 

\item{(14 April 2014) Stephen Curry has made 602 3-pointer attempts from beyond the arc,... are the \textbf{10th} most in NBA history in a season (\textbf{82 games})\footnote{\url{http://www.cbssports.com/nba/eye-on-basketball/24525914/} \url{stephen-curry-makes-history-with-consecutive-seasons-of-250-3s}}.}

\item{(28 May 2015) Stocks gained for the \textbf{seventh consecutive day} on Wednesday as the benchmark moved close to the 5,000 mark for \textbf{the first} time in seven years\footnote{\url{http://www.zacks.com/stock/news/176469/china-stock} \\ \url{-roundup-ctrip-buys-elong-stake-trina-solar-beats-estimates}}.}

\item{(9 Jun 2014) Delhi has been witnessing a spell of hot weather over the \textbf{past month}, with temperature hovering around 45 degrees Celsius, .... \textbf{highest} ever since 1952\footnote{\url{http://www.dnaindia.com/delhi/report-delhi-records} \\ \url{-highest-temperature-in-62-years-1994332}}.}

\item{(22 Jul 2011) Pelican Point recorded a maximum rainfall of 0.32 inches for \textbf{12 months}, making it the  \textbf{9th driest} places on earth\footnote{\url{http://www.livescience.com/30627-10-driest-places-on-earth.html}}.}
\end{enumerate}

In the above examples, each news theme is a \emph{ranked-streak} which consists of five components: (I)  a subject (e.g., Kobe Bryant, Stocks, Delhi), (II) a streak length (e.g., nine straight games, seventh consecutive days, past month), (III) an aggregate function on an attribute
(e.g., minimum points, count of gains, average of degrees), (IV) a rank (e.g., fourth, first time, highest), and (V) a historical dataset (e.g., all time list,
seven years, since 1952). The indicators (I)-(IV) are summarized in Table~\ref{tbl:news-example}.
%To compute the \emph{rank} (i.e., indicator (IV)), a \textbf{comparison neighborhood} is
%applied to group all streaks with identical lengths and sort them based on the order 
%of their aggregate values.
%
%The \emph{rank} is defined based on the streaks of the same lengths, which is
%an aggregation on the \textbf{comparison neighborhood} function.
Among all the ranked-streaks, our $k$-Sketch
query leverages a novel scoring function that chooses
the best $k$ ranked-streaks to summarize a subject's 
history. Our scoring function considers two aspects: (1) we prefer the ranked-streaks that cover as many events as possible to represent a subject's history, and (2) we prefer the ranked-streaks that have better ranks\footnote{We consider a ranked-streak with rank $i$ to be more attractive than $j$ if $i<j$ and the other fields are the same.} as they indicate more strikingness. Our objective is to process the $k$-Sketch query for each subject in the domain.

\begin{table}[t]
\caption{Indicators of ranked-streaks.}
\label{tbl:news-example}
\centering
\begin{tabular}{|l|l|l|l|l|}
\hline
\textbf{E.g.} & \textbf{Subject}& \textbf{Aggregate Function} & \textbf{Streak Length} & \textbf{Rank} \\
\hline
1 &  Kobe & min(points) & 9 straight games & 4 \\
\hline
2 &  Stephen & sum(shot attempts) & 82 games & 10 \\
\hline
3 &  Stock Index &count(gains) & 7 consecutive days & 1 \\
\hline
4 &  Delhi & average(degree) & past months (30 days) & 1 \\
\hline
5 &  Pelican Point & max(raindrops) & 12 months & 9 \\
\hline
\end{tabular}
\end{table}


We study the $k$-Sketch query processing under both offline and online scenarios. 
In the offline scenario, our objective is to efficiently discover the sketch for each subject 
from historical data. 
The major challenge lies in generating
the rank information of streaks. 
Since the number of streaks is quadratic with respect to the number of events, enumerating 
all of them is not scalable. By leveraging the subadditivity among the upper bounds of streaks, we design two effective pruning techniques to facilitate efficient ranked-streak generation.
Furthermore, we notice that generating exact sketches from ranked-streaks is computationally expensive. Thus, we design an efficient $(1-1/e)$-approximate algorithm by exploiting the submodularity of the $k$-Sketch query.

In the online scenario, fresh events are continuously fed into the system and our goal is to maintain the sketches for each subject uptodate. When a new event about subject $s$ arrives, many ranked-streaks of various lengths can be derived. For each derived ranked-streak,
not only the sketch of $s$ but also the sketches
of other subjects may be affected. Dealing with such a complex updating pattern is non-trivial. 
To efficiently support the update while maintaining the quality of sketches, we propose a $1/8$-approximate algorithm which only   
examines $2k$ ranked-streaks for each subject whose sketch is affected. 


%In the above news themes, there are a subject (e.g., Kobe Bryant, Stocks, Delhi), an event window (e.g., nine straight games, seventh consecutive days, past month), an aggregate function on an attribute
%(e.g., minimum points, count of gains, average of degrees), a rank (e.g., fourth, first time, highest), and a
%historical dataset (e.g., all time list, seven years, since 1952). These news theme indicators are summarized in Table~\ref{tbl:news-example}. 
%To avoid outputting near-duplicate news themes and control the result size,
%we further propose a novel concept named \emph{Sketch}. A sketch contains $k$ most representative rank-aware news themes under a scoring function that considers both strikingness and diversity. 
%Our objective is to discover sketches for each subject in the domain.




%\begin{table}[t]
%\caption{Summary of Rank-aware streaks}
%\label{tbl:news-example}
%\begin{tabular}{|c|c|c|c|}
%\hline
%\textbf{E.g.} & \textbf{Aggregate function} & \textbf{Event window} & \textbf{Rank} \\
%\hline
%1 & min(points) & 9 straight games & 4 \\
%\hline
%2 & sum(shot attempts) & 82 games & 10 \\
%\hline
%3 & count(gains) & 7 consecutive days & 1 \\
%\hline
%4 & average(degree) & past months (30 days) & 1 \\
%\hline
%5 & max(raindrops) & 12 months & 9 \\
%\hline
%\end{tabular}
%\end{table}

%In this paper, we aim to discover such \emph{rank-aware} news themes which are failed to be captured by~\cite{zhang2014discovering}. In our settings, a potential news theme is modelled as a \emph{window of sequenced events} named \emph{Event Windows}, over which users are allowed to apply aggregate functions. Then event windows with the same window length are compared based on their aggregated values to generate respective rankings. By so doing, event windows with better ranks are deemed to be more striking. Such striking event windows are referred as \emph{Candidate Themes}.


% we further propose the concept of \emph{Sketch}, which is a set of $k$ representative themes for a subject. 
%We design a novel scoring function to account for both strikingness and diversity when choosing candidate themes. Such a function not only ensures the output size of each sketch is manageable,
%but also avoids reporting near-duplicate themes whose corresponding event windows are similar. We name the problem
%of computing sketches as \emph{Sketch Discovery}.


%Unlike prominent streaks, the \textit{ranks} in each of
%the above news theme is derived globally from \textit{all} subjects, which makes them more attractive.
%Distinct from prominent streaks, the \textit{rank} in each above news theme is derived globally 
%from all subjects, which brings more attractiveness. 
%To discover such rank aware news themes,
%we propose an enhanced streak, called \emph{Event Window}. In our settings, user may specify aggregate functions 
%on event windows and all windows are ranked based on their aggregate value. Event windows with better ranks are considered to be newsworthy candidates themes.
%In particular, we allow users
%to define their own aggregate functions on a window of sequenced events, 
%the aggregated value and those events form an \emph{Event Window}. Then event windows of all subjects
%are compared based on their aggregate values to derive ranks. 
%The windows with better ranks are considered to be newsworthy candidates. 
%As the number of candidate themes may be large, 
%we further propose the concept of \emph{Sketch}, which is a set of $k$ representative themes for a subject. 
%We design a novel scoring function to account for both strikingness and diversity when choosing candidate themes. Such a function not only ensures the output size of each sketch is manageable,
%but also avoids reporting near-duplicate themes whose corresponding event windows are similar. We name the problem
%of computing sketches as \emph{Sketch Discovery}.

%Therefore, based on sketch, reporters can conveniently obtain the most striking themes for each subject, like the $10$ best streaks in Michael Jordan's career\footnote{http://bleacherreport.com/articles/1069931-michael-jordan-the-10-greatest-games-of-his-airness}, for news writing.

%%which is a set of $k$ most representative themes for each subject. 
%We model a \emph{Sketch Discovery} problem which aims to select $k$ news themes while account for both stringiness and diversity. This

%
%a user-defined aggregate function is applied on each window of sequenced events.
%The aggregated values from event windows of multiple subjects are compared to derive a rank. The windows with better ranks are considered to be more newsworthy. As the number of candidate themes may be large, 
%we propose the concept of \emph{Sketch}, which is a set of $k$ most representative themes for each subject. We then model a \emph{Sketch Discovery} problem which aims to select $k$ news themes while account for both stringiness and diversity. This

%This not only ensures the output size is manageable,
%but also avoids reporting near-duplicate themes whose corresponding window of events are similar and highly ranked. Therefore, based on sketch, reporters can conveniently obtain the most striking themes for each subject, like the $10$ best streaks in Michael Jordan's career\footnote{http://bleacherreport.com/articles/1069931-michael-jordan-the-10-greatest-games-of-his-airness}, for news writing.

%We study the sketch discovery problem under both offline and online scenarios. 
%In the offline scenario, the objective is to efficiently discover the sketches for each subject 
%from historical data. 
%The major challenge lies in generating
%candidate themes from event windows. Since the number of event windows is quadratic, enumerating 
%all of them is not scalable. By leveraging the subadditivity among the upper bounds of event windows, we design two effective pruning techniques to facilitate efficient candidate theme generation.
%Furthermore, we note that generating exact sketches from candidate themes is expensive. Thus, we design an efficient $(1-1/e)$ approximation algorithm by exploiting submodularity of the sketch discovery problem.

%In the online scenario, fresh data is continuously fed into the system and our goal is to maintain the sketches for each subject up-to-date. When a new event about subject $s$ arrives, many event windows of various lengths can be derived. For each derived event window,
%not only the sketch of $s$ but also the sketches
%of other subjects may be affected. Dealing with such a complex updating pattern is non-trivial. 
%To efficiently support the update while maintaining the quality of sketches, we propose a $1/8$ approximation solution which only   
%examines $2k$ candidate themes for each subject whose sketch is affected. 





%automatically detect newsworthy themes from the streaming data. 
%In the offline scenario, the major challenge lies in generating
%candidate themes. Given a sequence of events, the number of 
%potential candidate themes is quadratic. Therefore, enumerating 
%all possible candidate themes is not scalable.
%By leveraging the fact that candidate themes
%with larger window lengths can be estimated from those with smaller window lengths, 
%we propose a two \emph{window-level} pruning techniques to facilitate efficient 
%candidate theme generation. In addition, we note that finding exact sketches from candidate themes
%is very inefficient. Through exploiting submodularity of the sketch discovery problem, 
%we design a greedy algorithm with $(1-1/e)$ approximation ratio.
%
%%In particular, given a window length $w$, 
%%\emph{visiting-window} and \emph{unseen-window} prunings are devised to prune 
%%candidates with window length $w'=w$ and $w' > w$ respectively.
%%Moreover, finding exact sketches from candidate themes may incur quadratic complexity as well. 
%%Through exploiting submodularity of the sketch discovery problem, 
%%we design a greedy algorithm with $(1-1/e)$ approximation ratio.
%
%In the online scenario, we monitor the arriving events and update
%the sketches accordingly. A naive solution would invoke 
%offline discovery as each event   to update sketches, 
%which is trivially 
%prohibitive for real-time response. However, designing an efficient
%sketch update strategy is not an easy task. We notice
%that given an arriving event for a subject $s$, 
%not only the sketch of $s$ but also the sketches
%of other subjects can be affected. To support such compound 
%update patterns in real-time while not losing the quality of maintained 
%sketches, we propose a $1/8$ approximation solution which only   
%examines 2$k$ theme candidates for each subject whose sketch is 
%affected. 

Our contributions of this chapter are hereby summarized as follows:


\begin{itemize}
\item We study the neighborhood analytics in sequence data to tackle the problem
of automatic summarization of a subject's history. We use both the distance and comparison
neighborhood functions to model the ranked-streak, which is a common news theme in real-life reports but has not been addressed in previous works. We formulate the summarization 
problem as a $k$-Sketch query under a novel scoring function that considers both strikingness and coverage.

%We study the problem of automatic summarization of a subject's history. We utilize the ranked-streak 
%that is a common news theme in real-life reports but has not been addressed in previous works. We formulate the summarization 
%problem as a $k$-Sketch query under a novel scoring function that considers both strikingness and coverage.

\item We study the $k$-Sketch query processing in both offline and online scenarios. In the offline scenario, we propose two novel pruning techniques to efficiently generate ranked-streaks. Then we design a $(1-1/e)$-approximate algorithm to compute the sketches for each subject. In the online scenario, we propose a $1/8$-approximate algorithm to efficiently support the complex updating patterns as new event arrives.


\item We conduct extensive experiments 
with four real datasets to evaluate the effectiveness and the efficiency of our proposed algorithms. 
In the offline scenario, our solution is three orders of magnitude 
faster than baseline algorithms. While in the online scenario,
our solution achieves up to 500x speedup. In addition, 
we also perform an anonymous user study via Amazon Mechanical Turk\footnote{https://requester.mturk.com} platform,
which validates the effectiveness of our $k$-Sketch query.
\end{itemize}

%\begin{itemize}
%\item We study the automatic discovery of a new type of news theme that is common in real-life reports but has not been addressed in previous works. We formulate it as a sketch discovery problem under a novel scoring function that considers both strikingness and diversity.
%%We propose the notion of rank-aware event window to model striking news themes 
%%which assist journalist
%%in news writing. We focus on news themes generated from analytic events and introduce the \emph{rank} to express the strikingness of a news theme. We then 
%%and formulate the automatic news discovery as a novel sketch discovery problem to produce the best $k$ news themes
%%while account for both strikingness and diversity.
%%
%%\item We focus on news themes that are originated from analytic data. Such type of news themes has recently been studied in the literature and is of importance in computational journalism. We then propose and formulate a novel sketch discovery problem, 
%%which is more expressive and practical than 
%%previous works, to automatically detect striking news themes.
%
%\item We study the sketch discovery problem in both online and offline scenarios. In the offline scenario, we propose two novel pruning techniques to efficiently generate candidate themes. Then we design a $1-1/e$ greedy algorithm to discover the sketches for each subject. In the online scenario, we propose a $1/8$ approximation solution to efficiently support the complex updating pattern as each new event arrives.
%
%\item We conduct extensive experiments 
%with four real datasets to evaluate the efficiency of our proposed algorithms. In the offline scenario,
%our solution is three orders of magnitude faster than baseline algorithms. While in the online scenario,
%our solution achieves up to a 500 times speedup. In addition, 
%we also perform an anonymous human study via Amazon Mechanical Turk\footnote{https://requester.mturk.com} platform,
%which shows the effectiveness of sketch in news theme generation.
%\end{itemize}

The rest of this chapter is organized as follows. In Section~\ref{sec:problem_definition}, we formulate the $k$-Sketch query. Section~\ref{sec:offline} presents the algorithms for processing the $k$-Sketch query in the offline scenario. Section~\ref{sec:online} describes the algorithms for
maintaining $k$-Sketches in the online scenario.
In Section~\ref{sec:experiment}, comprehensive experimental studies on both the efficiency and the effectiveness of our algorithms are conducted.
Section~\ref{sec:discussion} discusses the extension of our methods. Finally,
Section~\ref{sec:conclusion} concludes our paper.
